(()=>{"use strict";class e{constructor(e="div",t=[]){this.element=document.createElement(e),""!==t.join("")&&this.element.classList.add(...t)}}class t extends e{constructor(e,t,s,n,i){super("button",["button",...i]),this.element.innerText=e,this.element.style.setProperty("--textColor",t),this.element.style.setProperty("--backgroundColor",s),this.element.style.setProperty("--borderColor",n)}}class s{constructor(e,t){this.title=e,this.text=t}}class n extends e{constructor(e,t){super("h1",["title",...t]),this.element.innerText=e}}class i extends e{constructor(e,t){super("p",["paragraph",...t]),this.element.innerText=e}}class a extends e{constructor(e){super("div",["task-content"]),this.taskTitle=new n(e.title,["task-title"]),this.element.append(this.taskTitle.element),this.taskText=new i(e.text,["task-text"]),this.element.append(this.taskText.element)}}class l extends e{constructor(){super("div",["task-buttons"]),this.deleteButton=new t("Delete","#800","#fff","#800",["task-button"]),this.element.append(this.deleteButton.element),this.editButton=new t("Edit","#c80","#fff","#c80",["task-button"]),this.element.append(this.editButton.element),this.disableButton=new t("Disable","#0c0","#fff","#0c0",["task-button"]),this.element.append(this.disableButton.element),this.activateButton=new t("Activate task","#07beb8","#fff","#07beb8",["task-button","task-activate-button"]),this.element.append(this.activateButton.element),this.readButton=new t("Read task","#80b8","#fff","#80b8",["task-button"]),this.element.append(this.readButton.element)}}class d extends e{constructor(){super("div",["edit-task-form-wrapper"]),this.inner=new e("div",["edit-task-form"]),this.titleInput=new e("input",["edit-task-form-input","edit-title-input"]),this.titleInput.element.setAttribute("type","text"),this.titleInput.element.setAttribute("placeholder","New Task's title"),this.inner.element.append(this.titleInput.element),this.textInput=new e("input",["edit-task-form-input","edit-text-input"]),this.textInput.element.setAttribute("type","text"),this.textInput.element.setAttribute("placeholder","New Task's text"),this.inner.element.append(this.textInput.element),this.setButton=new t("Set task","#fff","#0c0","#0c0",["set-button"]),this.inner.element.append(this.setButton.element),this.element.append(this.inner.element)}}const o=new SpeechSynthesisUtterance;let h=null;o.voice=h,speechSynthesis.addEventListener("voiceschanged",(function(){h=this.getVoices()[0]}));class p extends e{constructor(e,t){super("div",["task"]),this.data=e,this.content=new a(e),this.element.append(this.content.element),this.buttons=new l,this.element.append(this.buttons.element),this.id=t,this.editTaskForm=new d,this.element.append(this.editTaskForm.element),this.buttons.readButton.element.addEventListener("click",(()=>{o.text=this.data.title,speechSynthesis.speak(o),o.text=this.data.text,speechSynthesis.speak(o)}))}}const c=new SpeechSynthesisUtterance;let r=null;c.voice=r,speechSynthesis.addEventListener("voiceschanged",(function(){r=this.getVoices()[0]}));let m=new class extends e{constructor(){super("div",["add-task-form"]),this.titleInput=new e("input",["add-task-form-input","title-input"]),this.titleInput.element.setAttribute("type","text"),this.titleInput.element.setAttribute("placeholder","New Task's title"),this.element.append(this.titleInput.element),this.textInput=new e("input",["add-task-form-input","text-input"]),this.textInput.element.setAttribute("type","text"),this.textInput.element.setAttribute("placeholder","New Task's text"),this.element.append(this.textInput.element),this.addButton=new t("Add task","#fff","#0c0","#0c0",["add-button"]),this.element.append(this.addButton.element)}};document.body.append(m.element);let u=new class extends e{constructor(){super("div",["tasks-container"]),this.incompletedTasks=[],this.completedTasks=[],this.renderByTasks([],[])}renderByTasks(e,s){this.element.innerHTML="",this.readAllTasksButton=new t("Read all tasks","#80b8","#fff","#80b8",["read-all-tasks-button"]),this.element.append(this.readAllTasksButton.element),this.setReadAllTasksListener(),this.incompletedTasks=e.map((e=>new p(e.data,e.id))),this.completedTasks=s.map((e=>new p(e.data,e.id))),this.incompletedTasks.forEach(((e,t)=>{this.addDeleteTaskListener(e,!1),this.addEditTaskListener(e,t,!1),this.addDisableTaskListener(e),this.element.append(e.element)})),this.completedTasks.forEach((e=>{this.addDeleteTaskListener(e,!0),e.buttons.editButton.element.classList.add("invisible"),e.buttons.disableButton.element.classList.add("invisible"),e.buttons.activateButton.element.classList.add("visible"),this.addActivateTaskListener(e),e.content.element.classList.add("grey"),this.element.append(e.element)})),this.counter=new n(`Incompleted: ${this.incompletedTasks.length}\n      Completed: ${this.completedTasks.length}\n      At all: ${this.incompletedTasks.length+this.completedTasks.length}`,[]),this.element.append(this.counter.element)}setReadAllTasksListener(){this.readAllTasksButton.element.addEventListener("click",(()=>{c.text="Незавершённые задачи:",speechSynthesis.speak(c),0==this.incompletedTasks.length?(c.text="нету",speechSynthesis.speak(c)):this.incompletedTasks.forEach((e=>{e.data.title&&(c.text=e.data.title,speechSynthesis.speak(c)),e.data.text&&(c.text=e.data.text,speechSynthesis.speak(c))}))}))}addDeleteTaskListener(e,t){e.buttons.deleteButton.element.addEventListener("click",(()=>{t?this.completedTasks=this.completedTasks.filter((t=>t.id!=e.id)):this.incompletedTasks=this.incompletedTasks.filter((t=>t.id!=e.id)),this.renderByTasks(this.incompletedTasks,this.completedTasks)}))}addEditTaskListener(e,t,s){e.buttons.editButton.element.addEventListener("click",(()=>{e.editTaskForm.element.classList.add("open"),e.editTaskForm.titleInput.element.value=e.data.title,e.editTaskForm.textInput.element.value=e.data.text,e.editTaskForm.setButton.element.addEventListener("click",(()=>{this.setTaskListener(e,t,s)}))}))}setTaskListener(e,t,n){let i=new s(e.editTaskForm.titleInput.element.value,e.editTaskForm.textInput.element.value),a=new p(i,(new Date).getTime());n?this.completedTasks.splice(t,1,a):this.incompletedTasks.splice(t,1,a),e.editTaskForm.element.classList.remove("open"),this.renderByTasks(this.incompletedTasks,this.completedTasks)}addDisableTaskListener(e){e.buttons.disableButton.element.addEventListener("click",(()=>{this.incompletedTasks=this.incompletedTasks.filter((t=>t.id!=e.id)),this.completedTasks.push(new p(e.data,e.id)),this.renderByTasks(this.incompletedTasks,this.completedTasks)}))}addActivateTaskListener(e){e.buttons.activateButton.element.addEventListener("click",(()=>{this.completedTasks=this.completedTasks.filter((t=>t.id!=e.id)),this.incompletedTasks.push(new p(e.data,e.id)),this.renderByTasks(this.incompletedTasks,this.completedTasks)}))}};document.body.append(u.element),m.addButton.element.addEventListener("click",(()=>{let e=new s(m.titleInput.element.value,m.textInput.element.value),t=new p(e,(new Date).getTime()),n=!1;u.incompletedTasks.forEach((t=>{Object.entries(e).join()==Object.entries(t.data).join()&&(alert("This task already exists"),n=!0)})),u.completedTasks.forEach((t=>{Object.entries(e).join()==Object.entries(t.data).join()&&(alert("This task already exists"),n=!0)})),n||(u.incompletedTasks.push(t),u.renderByTasks(u.incompletedTasks,u.completedTasks),m.titleInput.element.value="",m.textInput.element.value="")}))})();